<div class="form-container-box">
  <!-- Left Stepper Box -->
  <div class="stepper-box">
   <mat-vertical-stepper [linear]="false" [selectedIndex]="currentStep - 1" class="custom-stepper">
  <mat-step label="Helper Details" [completed]="currentStep > 1"></mat-step>
  <mat-step label="Documents" [completed]="currentStep > 2"></mat-step>
  <mat-step label="Review"></mat-step>
</mat-vertical-stepper>

  </div>

  <!-- Step 1 & 2: Form Section -->
  <div class="form-section-box" *ngIf="currentStep !== 3">
    <h2>{{ isEditMode ? 'Edit Helper' : 'Add Helper' }}</h2>

    <form [formGroup]="form" (ngSubmit)="submitForm()">
      <div class="photo-upload-wrapper">
        <div class="photo-circle">
          <img *ngIf="photoPreview" [src]="photoPreview" alt="Photo Preview" />
          <mat-icon *ngIf="!photoPreview" class="upload-icon">cloud_upload</mat-icon>
        </div>
        <div class="photo-upload-info">
          <label class="photo-upload-label">
            Upload Photo
            <input type="file" (change)="onFileChange($event, 'photo')" hidden />
          </label>
          <small class="photo-hint">Upload photo (.png, .jpeg) size 5 mb</small>
        </div>
      </div>

      <div class="form-group">
        <label>Type of Service*</label>
        <select formControlName="serviceType">
          <option value="">Select</option>
          <option>Cook</option>
          <option>Driver</option>
          <option>Cleaner</option>
        </select>
        <div *ngIf="form.get('serviceType')?.invalid && form.get('serviceType')?.touched" class="error">
          Service type is required.
        </div>
      </div>

      <div class="form-group">
        <label>Organization Name*</label>
        <input type="text" formControlName="organization" />
        <div *ngIf="form.get('organization')?.invalid && form.get('organization')?.touched" class="error">
          Organization is required.
        </div>
      </div>

      <div class="form-group">
        <label>Full Name*</label>
        <input type="text" formControlName="fullName" />
        <div *ngIf="form.get('fullName')?.invalid && form.get('fullName')?.touched" class="error">
          Full name is required.
        </div>
      </div>

      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Languages*</mat-label>
          <mat-select formControlName="languages" multiple>
            <mat-option value="English">English</mat-option>
            <mat-option value="Hindi">Hindi</mat-option>
            <mat-option value="Telugu">Telugu</mat-option>
          </mat-select>
          <mat-error *ngIf="form.get('languages')?.invalid && form.get('languages')?.touched">
            At least one language is required.
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-group">
        <label>Address*</label>
        <input type="text" formControlName="address" />
        <div *ngIf="form.get('address')?.invalid && form.get('address')?.touched" class="error">
          Address is required.
        </div>
      </div>

      <div class="form-group">
        <label>Gender*</label>
        <label><input type="radio" value="Male" formControlName="gender" /> Male</label>
        <label><input type="radio" value="Female" formControlName="gender" /> Female</label>
        <label><input type="radio" value="Other" formControlName="gender" /> Other</label>
        <div *ngIf="form.get('gender')?.invalid && form.get('gender')?.touched" class="error">
          Gender is required.
        </div>
      </div>

      <div class="form-group">
        <label>Phone*</label>
        <input type="tel" formControlName="phone" placeholder="+91" />
        <div *ngIf="form.get('phone')?.invalid && form.get('phone')?.touched" class="error">
          Enter a valid 10-digit mobile number.
        </div>
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" formControlName="email" placeholder="example@abc.com" />
        <div *ngIf="form.get('email')?.invalid && form.get('email')?.touched" class="error">
          Enter a valid email address.
        </div>
      </div>

      <div class="form-group">
        <label>Choose Vehicle Type</label>
        <select formControlName="vehicleType">
          <option value="">None</option>
          <option value="2-wheeler">2-wheeler</option>
          <option value="4-wheeler">4-wheeler</option>
        </select>
      </div>

      <div class="kyc-upload-wrapper">
        <div class="kyc-box">
          <img *ngIf="kycPreview" [src]="kycPreview" alt="KYC Preview" />
          <mat-icon *ngIf="!kycPreview" class="upload-icon">insert_drive_file</mat-icon>
        </div>
        <label class="kyc-upload-label">
          Upload KYC Document
          <input type="file" (change)="onFileChange($event, 'kyc')" hidden />
        </label>
        <small class="kyc-hint">Upload document (.png, .jpeg, .pdf) size 5 mb</small>
      </div>

      <button *ngIf="!isPreviewMode" type="submit">
  {{ isEditMode ? 'Update' : 'Add' }} Helper
</button>

<!-- Show this button only in Preview Mode (Step 3) -->
<button *ngIf="isPreviewMode" type="button" (click)="finalSubmit()">
  Confirm & Submit
</button>
    </form>
  </div>

  <!-- Step 3: Preview Section -->
  <div class="form-section-box" *ngIf="currentStep === 3">
    <h2>Preview Helper Details</h2>
    <div class="preview-content">
      <p><strong>Full Name:</strong> {{ form.value.fullName }}</p>
      <p><strong>Phone:</strong> {{ form.value.phone }}</p>
      <p><strong>Email:</strong> {{ form.value.email }}</p>
      <p><strong>Address:</strong> {{ form.value.address }}</p>
      <p><strong>Gender:</strong> {{ form.value.gender }}</p>
      <p><strong>Organization:</strong> {{ form.value.organization }}</p>
      <p><strong>Service Type:</strong> {{ form.value.serviceType }}</p>
      <p><strong>Languages:</strong> {{ form.value.languages?.join(', ') }}</p>
      <p><strong>Vehicle Type:</strong> {{ form.value.vehicleType || 'None' }}</p>

      <div class="preview-actions">
        <button (click)="currentStep = 1">Back to Edit</button>
        <button (click)="finalSubmit()">Confirm & Submit</button>
      </div>
    </div>
  </div>
</div>
